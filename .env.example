# ===========================================
# Keyway API - Environment Variables
# ===========================================

# -----------------------------------------
# Server Configuration
# -----------------------------------------
PORT=3000
HOST=0.0.0.0
NODE_ENV=development
LOG_LEVEL=info

# -----------------------------------------
# Database
# -----------------------------------------
# PostgreSQL connection string
# Format: postgresql://[user]:[password]@[host]:[port]/[database]
DATABASE_URL=postgresql://user:password@localhost:5432/keyway

# -----------------------------------------
# Encryption
# -----------------------------------------
# CRITICAL: AES-256-GCM encryption key for secrets at rest
# - Must be a 64-character hexadecimal string (32 bytes)
# - Generate with: openssl rand -hex 32
#
# WARNING - KEY ROTATION NOT SUPPORTED:
# Once secrets are stored, this key CANNOT be changed without losing data.
# There is currently no migration path to re-encrypt secrets with a new key.
#
# RECOMMENDATIONS:
# 1. Generate a strong key BEFORE storing any secrets
# 2. Back up this key securely (it cannot be recovered)
# 3. If compromised, you must delete all secrets and re-push them after key change
#
ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# -----------------------------------------
# JWT (for device flow tokens)
# -----------------------------------------
# CRITICAL: Must be at least 32 characters
# Generate with: openssl rand -base64 32
JWT_SECRET=your_jwt_secret_at_least_32_characters_long_please_change_this

# -----------------------------------------
# GitHub App (Unified Auth + Repo Access)
# -----------------------------------------
# Keyway uses a single GitHub App for:
# 1. User authentication (OAuth via GitHub App)
# 2. Repository access (installation tokens)
#
# Create a GitHub App at: https://github.com/settings/apps/new
#
# Required settings:
# - Callback URL: https://your-domain/v1/auth/callback
# - Request user authorization during installation: ✓
# - Enable Device Flow: ✓
#
# Required permissions:
# - Repository: Metadata (Read-only)
# - Repository: Administration (Read-only)
# - Account: Email addresses (Read-only)
#
# Subscribe to events:
# - Installation
# - Installation repositories

# App ID (shown in app settings)
GITHUB_APP_ID=123456

# Client ID (starts with Iv1.)
GITHUB_APP_CLIENT_ID=Iv1.xxxxxxxxxxxxxxxx

# Client secret (generate in app settings)
GITHUB_APP_CLIENT_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Private key (base64-encoded .pem file)
# Generate: base64 -i your-app.private-key.pem | tr -d '\n'
GITHUB_APP_PRIVATE_KEY=LS0tLS1CRUdJTi...

# Webhook secret (optional but recommended)
# Generate: openssl rand -hex 32
GITHUB_APP_WEBHOOK_SECRET=

# App slug name (used for install URL)
GITHUB_APP_NAME=keyway

# -----------------------------------------
# Analytics (Optional)
# -----------------------------------------
# PostHog API key - Leave empty to disable analytics
# POSTHOG_API_KEY=
POSTHOG_HOST=https://app.posthog.com

# -----------------------------------------
# CORS Configuration
# -----------------------------------------
# Comma-separated list of allowed origins for production
# Leave empty in development to allow all origins
# Example: ALLOWED_ORIGINS=https://app.keyway.sh,https://keyway.sh
ALLOWED_ORIGINS=

# ===========================================
# Notes:
# ===========================================
# 1. Copy this file to .env and fill in your values
# 2. NEVER commit .env to version control
# 3. In production, set NODE_ENV=production
# 4. Generate a secure ENCRYPTION_KEY - NEVER use the example value
# 5. Set ALLOWED_ORIGINS in production for security
